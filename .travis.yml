language: elixir
elixir:
- 1.7.2
otp_release:
- 21.1.3
cache:
  directories:
  - _build
  - deps
jobs:
  include:
    - stage: code format check
      script: mix format --check-formatted
    - stage: test
      script: mix test
    - stage: code analysis
      script: mix credo
    - stage: coverage
      script: MIX_ENV=test mix coveralls.travis
    - stage: build release
      script: MIX_ENV=prod mix release --quiet
      if: branch = master
before_deploy:
- openssl aes-256-cbc -K $encrypted_fb19f4b5929a_key -iv $encrypted_fb19f4b5929a_iv
  -in travis_rsa.enc -out /tmp/travis_rsa -d
- chmod 600 /tmp/travis_rsa
deploy:
  skip_cleanup: true
  provider: script
  script: bash scripts/deploy.sh
  on:
    branch: master
env:
  global:
  - secure: LPnzgME58jzJWn4c2KdkOGNAIpWB6rqx91C0j0ZNd62ClrUFFTcMEPuZvZJEjq9GCTuHWAoclYVVLmNOY56pG26O3HRAvMaFS39yH8Ppr0z6U64OMLzuwa5L2SuJSwH+obQPDfjMXE5CIPBxp/9iKLIh4NWCnrEvJ4FUZyKl/aZpk3t5OXp+46YZ3aYxkDrpmPy7VtsYwmDdCftBLkF8l0Y+giZ9ThVRvrgZg6IVRCiVroWszseuFroUHht3F6oWXCiFijyvYy+1y4CCTVrfCY8wxspvVfT2xP7DswbG9LG0lKdZw8ziPdT8Bp6l9esmUcTp0zadP7XmxDLSrF00Z+vgaEqbQr/8SwANJipCedD7G47l10tAnJxh4yMCN0p4z6kb2BLdh7kkAZmaWOfvnFw/p0Yw6pzvBZ8y+Kw38S1/CRV/17YnOEZRMTTSirF0xDwzJVfQFtNscR2V+uDZ3Hu4A52fMhBoyWm8zBitieBEzVCanoMd45se0mqtDoYsUiqrsQxPZC7SrV5DXJkyqXRxNlw0gLvbxoNywUZaz/TQ+1+FOxE2SGwMI0XSntV7PbsS7T72SlN4B156rgMSTSpo+nLFoebTNuVHOET/EoA1wkw+/sSoAB8ChztPfV1STaO/Ulg/BkAC3I/gfEtuPGVQOY+R/JDR5AV3du/dI0w=
  - secure: RtuveqsDXVTql/MZoKlio2hEXsowrBqX7YTd8THueKS+p2TqeCG2UYfE59YmB13FjOlm6fVuI8veWKx0XVqKp3BmTzaB3Uf3EgTVVdHa0WPRMFSUu5D7+sHRjGm7P2Z1XGnKanKKoZZCOoLayYfPe+FSqROQ5AYOwpRdnHg25s6Na5EnvhL5fNJTxcU4XqWHQsNuqSj41QYWdFQy4cMmwrHwboDQ87B9KsBFe6a1qk1lJd+SdVJO5bew3j62XwZ1C+b9RNrBOmiqQ6qFiZivzH0NXRM0/hvL/h5qeJ3mOHeUNnQR7OAq5GRbP1xyougzPb3hIumoDsX3N7bW4ybshN0cuBPVEePL6jbj91LJnl4KKhCdxddpino4ml+LP4aZGZTOQX7sPC2Yq8L55MMCLWFds1+MuH1Ts5EApssOaPqVKvJuakU6jQ8MpmfIzmb98nsk2EGNAkLYeBiosV896eQQUigUs+U4imH6JqLRvOOEHK24wIy4Wxr0UMVvI+j1k3+g4SJJqZq7DAd5hIDFxe8IxzbHUHkJbBsQ9cHqxU4nb+o3u//CLNUkO0RdzNwT69fgUxavr10gfGmTsBX9e6torqDzLJ4/sUmGEJeWYO2OPg976T8tAgSWHRT1PcdPqO6G55Qg5l/G7ZZvzD5RHkso8ShSkNMh4+WiQ3ZMqQo=
  - secure: UWoU7mxkrc5W2oquldj7oO5hzbNj6v3lZ0eez5e/bPqBLTQGlIjTBjcbpSjidVcEpaeXBBO2k54Vkaww4enHdYqvoZlj2LlTI5az+fv7Ukk78VZ/zlqNpZuT6eBhDfJ94EisdgrbpeEel8lyMkPihzoV9YiVvmoK7ptknLBRgfxufq31zVID9DOjOCcq+r32KY5vV4nv1QouM1LtnE4yP0jAK4mCt/UhY7BxCHEq3daRbCSiNxShgCytu7yZ+p/BLcTUkMPVSCkXINcalX67eOFIo7kBRSMDKtdnAJA+bz0Fb3LJqcRgq2thldRAsvcShMAHyTsF/VvyWoze+idw6p7HsBbn0HNl8WbdVJf67SZ5CTHw1MH0rJqUUNhT5VN/waQBZJ7ekAFGNVbL/tyGWlRFqSIO0O9mWcqr4u/jB/WYLTM9pkOWneXSduEVoypGBszRE5NMpDLOKBkT5OX3EWNkwgQ3Lx8Y3NpgF22nX5wmFr/7MskhVUzKpw4h0mYYtIK6KmNIbFP78QQczx1FAT0TUh9KO4jyzCbMQGVmuhiWGibQEr3z4+mrtdjqax4SqtaNsUkxcSohkJmswjKGE+9vKYgfcAsNtlOnrl3N7kXzW25Dz0cb60VavOivJyjeFlEYn5kKK43x5toj3DkR/gAhUd56Mv1sMLaMLWjROno=
  - secure: V5muajRpLdqZYTXVNzsgi4dfSXnTvCQy2WcGmC+CwH9k42lZsIe7WVPzdljXPpQWuXJZy/k3r8EdOVSSqaynnc5AI3ZdORZNbxWRvH8JNEX9eDciHKUXAoy3YF0DoREA5Xy33hHiMjn1xeajLhsi8mgI3RdmpghdILanmLd6ovtDYiW7KTm84htk+lCfJE0gEfyxBswxenLQUGue4oHTBaM6s1GD2eDijXICebbr1SZw+ouQsmGQTOQ/e7vV/+8BDdnBpCl/lpHvvNMLZaTM34SkqOePQ9sIb/GppRL5odscnoZbOzgMk1V5HWVI//rkQxpZeh6hUxxBMB8vGVwUQgMavzr1ni4iG6UWVqjMr1jdHSmd1BqpyubXkL52Cs9PaBBDXj1PqH3LZUDCMusVLyh7s3mN2ObE4mafxU695k3ceHNkddXdOFhceHnj+YlJZqDELMnOT+vG9NfFkom+PgJsXq2izQ0Eu1hWjz1pGboSfgr0Wta6XxgNVp/i5R5OfQi9U1nZa1LwM6Vj22A+BJro5zdsNGx3btdQXmQcr0hhBZJrVrgSjWsylamA0TreTvXUoY05qL2ESE2I/Q5xmR53Iq5Rkq15403b0MXBVQnR2KeUC7jyixs3inFD4hYsylJQjJX3t5w31QZcNl/WgpPkShq0mIdTb+VvZVSih00=
  - secure: HR68bSStln2n4kEX12sg5Tx8HE8N6BEls19YWs1qKtOuY+666wYNTqy72rHudIuG2ss9VnwYzgA+kyoiJRqwbcRAKB5ArRvJwNmAxIN+jhcPkAmtrRW8PJSHfxsYXHF7zA3UaXxy818OyWZtpyEYE55Sz6YS3qnTGkIWseS8jAppkZkagE3inaqp5oFAq3J81A17pIU8oAjKMI3IjPe50Dg+xKPy0ENv3OMCAU5ELTufJEtrYWt0vGEeL1ig5F4iAnBsUdCYf3FcfxPKsKQOOEDhshH1LxarzDDnAC/u0zyh/ZxerQaSIdphMn4JMSAH9RV7Sao0bqwlXrn6H19Bjd6/wjMnMWD63uDjozv0XSXUhMnuu3qWD1B5BxVUmiWpCIPCyVqsgDzJvkR4R2YBblYKsfDw9AQy+xTME6XS25ovsTB0eNazyYueGLedMDn63oZCaWGNsFQ5PLZc6pHj7atpLdQSCCnL6WiWLQzm2lc6+cKGP0me6GyeSwVXq+ScocNHg6MdMQecvrGp8BUwLuzDovbr9hnJrxmqAF2DuvYwNrIr08U8wjK/3vStF8OinJbtybCE6P88XLl+hnPC4ZrKHuK+c/UooYds4Hi/XG8xGdx491RN1AnTc3/U5wx151i2m4nItV5v9SKI2GU2t1KFON6KSE1Ddlwmv9m2tQ4=
  - secure: a8e137tWTBwIbACyM6Q1xTrY8P5xUXfy8zlYzcPOYAWVBu0o8RdFID//Z9r3fwSo0/wgSQ2YagMn7dqQPY6f7zQSQC7uP8oHvNVU5siTq+IZkx0KFrhnCZatMcZ4bdvsWjg6Eb4ztcRjGyNagN6ITMH1RLDHUCivvqha+PJAXCJYfKsvHj2fxpUQOf2dRYLbWANJKP5BMmmjgPVEou9C31c3LCGN2M6Dm/paqNRJlLB8tdns0lwnPZX2UqWinAffcJXS84cLQf9Ul/R5f+aDxtz+vpYezojdLfe9/r/t2NtV0sndCzLF+4EwvaMYTRbCU2BMoXRBB0wMtCV7lFP+gvrJGHQsnEQYQg7zEGqfvUAYkgMo+e/2Qjw0mqi9m8VozjVOBitmGge50Un9GaGYNwOwBBvjQkuq2ifTfq1wY7YJzSBROxuFOAcmyStLPckEmU1nvna4uJE1QetKcVZjBfu1luHY9iYCsiYPAQn3IynY8fe9QUVKUtkszQ72Z1+TEJbHyN8P/lGjZWhaw6LVjJ12xz8FQAboKiBw/nkFKar4iH/Sy8WjeVeG5NOn1D3xtYQyxRwatRN2rv+M35bMjWRDx9sj8P37tvYOCKr6TOVGTa7eoPVNIcQJ1wcRtnTXO5E7ak+kpRstgHx8f8smbPW95YDENR53AAPiIsEtzxI=
  - secure: JBysKFSedRr583qaj037zuV7FjEL7x/Oe8EXkoKSECLqK63VPHdQN3Kqs90p8/VFjXXggiV3n4IxKxwmZtwEDy6pQIMk4VlNzg34n73LyBB2kY/97qJ+yj6RfgveNFqAzyE8TcL37vLg1e0NTvLH6VOISU82MOoBu5Yi3PGgUCfUe9hNpwPChyjpMKynZfxUKiv8sNFwEbGwxr2pHN4J797UzXb8wslcwHZN0e3bFqrqeuIPZK/RED3hoyAY7NXfxg9sG9U7L3Kwo+xJa/Yu1rfDy7tH1RUBPRvTxRyMVd/GHKL/0ZyXlFxtARnPB6839Q0HnxF/CsZWf8yujqcI7QMaU8swU5LnLQax34uKIAaBUOo7ZJMPU7UBYsjoeAGoIROsFoYE8U1UJzynRy8FpCJUSuxLTfK8wO5yxXpO6MNPC5Wvm6NbbgAUARozUMr8iUQ4mGucvxV114+ddpJBS0aOykhJHVxqA4+RtMMjoa3AhT6wVIsvpxdsznnpWfGfEOx6QBCtnxUyt04BEqt6Y3gxZd1GmRErnloIZNfb4beGcIbO0bzIo9f8IGDkX4PpXbLqsFCqPXq/p0BozE3XAPjSxHOLEEBplrjSHRDA/Wdvth4ItpE8PF9wEzrTgr7vJ+ciAeH0Wjbyyz5KqXRgGYrSUPmUYa8YXT9UDEN7LxE=
  - secure: PtESn1rcCrlNT3HEb/MFDqiYfc3nqhRWgFB+I25JxvZPxACwHuCIUIJYF1gsE2QhREYMM8Hetw9xt/S1MaaHm7+l3nMviQpWlM4PMJUhUMI155WclcPxLTB72Hu3e3cVZkj8P8BsHUa6tliHl7PhP3pkF5+4Sn6nA9pK/755WVjeyxlui6fAx5vh7wYMbE3WXzm8JexRkhhKzjRSr28bcCrfzyEi4Ei9z7GHAAgypA7bnWfMY9CDYJdNkrM0/N1iZ8dYn15C5VoBl5tdcIt8mCaid6wfTTLoTCJZ6TPOwRk1Tqd+fE5XqvbecySzSANfM+RJH0mmQbTYdrFczpF6eboYEhbCPezDml9XrNe5+4PDspOexBCmPOw48ShbhAMKJtm2sBvfWaXnBBKFNXrzpPpEvQCtvASo1yVDCD2daBXHyjtBmSibMCA+ZNIfAKdZ6n/2Q5qdgOXf6q8mA4+cWL03vsHR6D94qQMC3EnsyhTR45NWEuU/php8iUygxM2mahr6lEN/YMdwJi424I3us4bqMnQFgZh1DlqrjWzzYaUxlDRbO7ces+Q7fds9SxS0idv/VmzAozwQ0FHF4yL30tTryhzZ+9wL4sAgFyMmb+8llGzcLPQbSjuG8gq4WYtbgUKSa/K4uZRzHz4h8ukuortZaNA4TERRbSedHy2WQak=
